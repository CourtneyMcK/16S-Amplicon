# 16S-Amplicon-ENVS6452-Assignment 3
Processing raw paired end 16S Amplicon sequencing data (generated by Illumina MiSeq) using the [DADA2 pipeline](https://benjjneb.github.io/dada2/index.html) for an assignment for ENVS*6452. R Markdown file was produced based on a modified version of the DADA2 tutorial listed on [DADA2 website (for version 1.16)](https://benjjneb.github.io/dada2/tutorial.html). Please visit the [DADA2 pipeline github page](https://github.com/benjjneb/dada2) for new updates or [resolving current issues](https://github.com/benjjneb/dada2/issues).

# Installation
Note: R version 4.5.1 and R Studio version 2025.09.0 were used to create and run the R Markdown file. To be able to certain download packages from the listed Bioconductor version, it requires R version 4.5 or greater.

To install DADA2 package from Bioconductor (version 3.21):
```{}
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("dada2", version = "3.21")
```
The following packages are also needed for processing DADA2 outputs and graphing data (if desired) in R:

[phyloseq](https://joey711.github.io/phyloseq/) (from Bioconductor version 3.21) (will be used to import, store, analyze large and complex sequencing datasets):
```{}
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("phyloseq", version = "3.21")
```
Biostrings (from Bioconductor version 3.21) (will be used for table manipulation of large biological sequences or sets of sequences):
```{}
if (!requireNamespace("BiocManager", quietly = TRUE))
    install.packages("BiocManager")
BiocManager::install("Biostrings", version = "3.21")
```

tidyverse (version 2.0.0 was used) (will be used for table manipulation and viewing):
```{}
install.packages ("tidyverse")
```

ggplot2 (version 4.0.0 was used) (will be used for graphing):
```{}
install.packages ("ggplot2")
```

RColorBrewer (version 1.1-3 was used) (nice colour palette for graphs):
```{}
install.packages ("RColorBrewer")
```

# Databases
SILVA database (Version 138.2 to Species Level-silva_nr99_v138.2_toSpecies_trainset.fa.gz) was used to assign taxa to ASVs. You can download it [here](https://zenodo.org/records/14169026) and change the directory of the command to where you saved the database on your personal computer.

# How to Use
Download R Markdown file to access script. There will be parts in the script (highlighted in CAPITAL LETTERS and explanation points!!!) where sections will need to changed before pressing play (will notice near the beginning). Please modify to file paths/data needs (an example is shown within the script).

Note: Raw sequencing data must be demultiplexed and the forward and reverse fastq files contain reads in matched order prior to using script.

# Output
Running through the script will process raw paired end 16S Amplicon sequencing data through the DADA2 pipeline to create a ASV table (with assigned taxa for each unique ASV sequence), modify the DADA2 outputs to be able to import/use with phyloseq and then graph the relative abundance data for Phylum and Order levels using geom_bar. 

Additionally, there are two extra scripts at the end demostrating how the graphs (Phylum used as an example) can be modified to change graph type to show different representations of relative abundance data (e.g., geom_point or heat map).
